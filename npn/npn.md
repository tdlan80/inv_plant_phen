codes from rnpn data pipeline
